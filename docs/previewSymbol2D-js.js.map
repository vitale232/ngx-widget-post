{"version":3,"sources":["./node_modules/@arcgis/core/symbols/support/previewSymbol2D.js"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAC0W,yCAAyC,gBAAgB,sCAAsC,kEAAC,iDAAiD,kEAAC,yHAAyH,8DAAC,OAAO,4CAA4C,iDAAiD,oCAAoC,kFAAkF,eAAe,qBAAqB,qCAAqC,kEAAC,iBAAiB,kBAAkB,sBAAsB,+BAA+B,gBAAgB,MAAM,qBAAqB,mBAAmB,4BAA4B,EAAE,4BAA4B,EAAE,4BAA4B,EAAE,4BAA4B,GAAG,MAAM,uBAAuB,mBAAmB,4BAA4B,EAAE,4BAA4B,EAAE,4BAA4B,EAAE,4BAA4B,EAAE,sBAAsB,EAAE,gBAAgB,MAAM,sBAAsB,mBAAmB,yBAAyB,EAAE,yBAAyB,EAAE,yBAAyB,EAAE,yBAAyB,EAAE,sBAAsB,EAAE,gBAAgB,MAAM,wBAAwB,mBAAmB,4BAA4B,EAAE,yBAAyB,EAAE,yBAAyB,EAAE,sBAAsB,EAAE,gBAAgB,MAAM,iBAAiB,mBAAmB,yBAAyB,EAAE,yBAAyB,EAAE,yBAAyB,EAAE,yBAAyB,GAAG,MAAM,oBAAoB,4BAA4B,qBAAqB,MAAM,mBAAmB,kDAAkD,2BAA2B,mBAAmB,yBAAyB,EAAE,yBAAyB,GAAG,MAAM,8KAA8K,uDAAC,eAAe,uDAAC,SAAS,MAAM,sBAAsB,MAAM,kEAAC,YAAY,kEAAC,WAAW,4BAA4B,uHAAuH,mFAAmF,MAAM,YAAY,uDAAuD,kEAAC,iCAAiC,gCAAgC,wIAAwI,IAAI,uCAAuC,8BAA8B,YAAY,sBAAsB,yBAAyB,eAAe,QAAQ,kEAAC,oBAAoB,oBAAoB,kBAAkB,oBAAoB,uBAAuB,uBAAuB,uCAAuC,wCAAwC,qBAAqB,qBAAqB,mBAAmB,yGAAyG,YAAY,8EAA8E,OAAO,mBAAmB,oEAAC,KAAK,sDAAC,gEAAgE,QAAQ,4DAAC,kBAAkB,WAAW,2DAA2D,2EAAC,gEAAgE,qEAAC,iBAAiB,cAAc,kGAAkG,aAAa,YAAY,wBAAwB,8EAAC,QAAQ,YAAY,uBAAuB,8EAAC,OAAO,UAAU,OAAO,oEAAC,UAAU,4CAA4C,EAAE,GAAgC","file":"previewSymbol2D-js.js","sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.18/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Error.js\";import{reject as t,resolve as a}from\"../../core/promiseUtils.js\";import{pt2px as l,px2pt as n}from\"../../core/screenUtils.js\";import{getStroke as s,getFill as o,getPatternUrlWithColor as i}from\"./gfxUtils.js\";import{shapes as r,adjustColorBrightness as c}from\"./previewUtils.js\";import{renderSymbol as m}from\"./renderUtils.js\";const u=document.createElement(\"canvas\");function p(p,h){const d=null!=(null==h?void 0:h.size)?l(h.size):null,f=null!=(null==h?void 0:h.maxSize)?l(h.maxSize):null,v=null!=(null==h?void 0:h.opacity)?h.opacity:null,y=null!=(null==h?void 0:h.rotation)?h.rotation:null,g=s(p),M={shape:null,fill:null,stroke:g,offset:[0,0]};null!=g&&g.width&&(g.width=Math.min(g.width,80));const w=(null==g?void 0:g.width)||0;let b=null!=d&&(null==(null==h?void 0:h.scale)||(null==h?void 0:h.scale)),x=0,k=0;switch(p.type){case\"simple-marker\":{const e=p.style,t=Math.min(null!=d?d:l(p.size),f||120);switch(x=t,k=t,e){case\"circle\":M.shape={type:\"circle\",cx:0,cy:0,r:.5*t},b||(x+=w,k+=w);break;case\"cross\":M.shape={type:\"path\",path:[{command:\"M\",values:[0,.5*k]},{command:\"L\",values:[x,.5*k]},{command:\"M\",values:[.5*x,0]},{command:\"L\",values:[.5*x,k]}]};break;case\"diamond\":M.shape={type:\"path\",path:[{command:\"M\",values:[0,.5*k]},{command:\"L\",values:[.5*x,0]},{command:\"L\",values:[x,.5*k]},{command:\"L\",values:[.5*x,k]},{command:\"Z\",values:[]}]},b||(x+=w,k+=w);break;case\"square\":M.shape={type:\"path\",path:[{command:\"M\",values:[0,0]},{command:\"L\",values:[x,0]},{command:\"L\",values:[x,k]},{command:\"L\",values:[0,k]},{command:\"Z\",values:[]}]},b||(x+=w,k+=w);break;case\"triangle\":M.shape={type:\"path\",path:[{command:\"M\",values:[.5*x,0]},{command:\"L\",values:[x,k]},{command:\"L\",values:[0,k]},{command:\"Z\",values:[]}]},b||(x+=w,k+=w);break;case\"x\":M.shape={type:\"path\",path:[{command:\"M\",values:[0,0]},{command:\"L\",values:[x,k]},{command:\"M\",values:[x,0]},{command:\"L\",values:[0,k]}]};break;case\"path\":M.shape={type:\"path\",path:p.path||\"\"},b||(x+=w,k+=w),b=!0}break}case\"simple-line\":{const e=Math.min(null!=d?d:w,f||80),t=e>22?2*e:40;g.width=e,x=t,k=e,M.shape={type:\"path\",path:[{command:\"M\",values:[0,k]},{command:\"L\",values:[x,k]}]};break}case\"picture-fill\":case\"simple-fill\":x=Math.min(null!=d?d:22,f||120)+w,k=x,b=!0,M.shape=\"object\"==typeof(null==h?void 0:h.symbolConfig)&&null!=h&&h.symbolConfig.isSquareFill?r.squareFill[0]:r.fill[0];break;case\"picture-marker\":{let e=l(p.width),t=l(p.height);const a=Math.max(e,t),n=e/t;e=n<=1?Math.ceil(a*n):a,t=n<=1?a:Math.ceil(a/n),x=Math.min(null!=d?d:e,f||120),k=Math.min(null!=d?d:t,f||120),M.shape={type:\"image\",x:-Math.round(x/2),y:-Math.round(k/2),width:x,height:k,src:p.url||\"\"};break}case\"text\":{const e=p,t=e.text||\"Aa\",a=e.font,s=Math.min(null!=d?d:l(a.size),f||120),o=function(e,t){const a=u.getContext(\"2d\"),l=[];return t&&(t.weight&&l.push(t.weight),t.size&&l.push(t.size+\"px\"),t.family&&l.push(t.family)),a.font=l.join(\" \"),a.measureText(e).width}(t,{weight:a.weight,size:s,family:a.family}),i=/[\\uE600-\\uE6FF]/.test(t);x=i?s:o,k=s;let r=.25*function(e){if(0===e.length)return 0;if(e.length>2){const t=n(1),a=parseFloat(e);switch(e.slice(-2)){case\"px\":return a;case\"pt\":return a*t;case\"in\":return 72*a*t;case\"pc\":return 12*a*t;case\"mm\":return 2.8346456692913384*a*t;case\"cm\":return 28.346456692913385*a*t}}return parseFloat(e)}((a?s:0).toString());i&&(r+=5),M.shape={type:\"text\",text:t,x:0,y:r,align:\"middle\",decoration:a&&a.decoration,rotated:e.rotated,kerning:e.kerning},M.font=a&&{size:s,style:a.style,decoration:a.decoration,weight:a.weight,family:a.family};break}}if(!M.shape)return t(new e(\"symbolPreview: renderPreviewHTML2D\",\"symbol not supported.\"));const L=o(p),z=L,j=p.color;let C=null;return z&&\"pattern\"===z.type&&j&&\"picture-fill\"!==p.type?C=i(z.src,j.toCss(!0)).then((e=>(z.src=e,M.fill=z,M))):(M.fill=L,C=a(M)),C.then((e=>{const t=[[e]];if(\"object\"==typeof(null==h?void 0:h.symbolConfig)&&null!=h&&h.symbolConfig.applyColorModulation){const a=.6*x;t.unshift([{...e,offset:[-a,0],fill:c(L,-.3)}]),t.push([{...e,offset:[a,0],fill:c(L,.3)}]),x+=2*a}return m(t,[x,k],{node:h&&h.node,scale:b,opacity:v,rotation:y})}))}export{p as previewSymbol2D};\n"],"sourceRoot":"webpack:///"}